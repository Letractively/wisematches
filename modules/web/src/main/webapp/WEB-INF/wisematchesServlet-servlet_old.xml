<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <import resource="classpath:/config/OLD-web-server-config-OLD.xml"/>

    <bean id="hibernateSessionInterceptor"
          class="org.springframework.orm.hibernate3.support.OpenSessionInViewInterceptor">
        <property name="sessionFactory" ref="sessionFactory"/>
    </bean>

    <bean id="languageChangeInterceptor"
          class="wisematches.server.deprecated.web.server.language.QueryLanguageInterceptor">
        <property name="visibleUrls">
            <set>
                <value>/app</value>
                <value>/signin</value>
            </set>
        </property>
    </bean>

    <bean name="remoteServiceHandlerAdapter" class="wisematches.server.deprecated.web.rpc.RemoteServiceHandlerAdapter">
        <property name="playerSessionsManager" ref="playerSessionsManager"/>
    </bean>

    <bean name="controllerHandlerAdapter" class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"/>

    <bean name="transactionalUrlMapping" parent="abstractUrlMapping">
        <property name="allowedType" value="TRANSACTIONAL_ONLY"/>

        <property name="interceptors">
            <list merge="true">
                <ref bean="hibernateSessionInterceptor"/>
            </list>
        </property>
    </bean>

    <bean name="notTransactionalUrlMapping" parent="abstractUrlMapping">
        <property name="allowedType" value="NOT_TRANSACTION_ONLY"/>
    </bean>

    <bean name="/rpc/CheckPointService"
          class="wisematches.server.deprecated.web.modules.login.services.CheckPointServiceImpl">
        <property name="accountManager" ref="accountManager"/>
        <property name="mailSender" ref="mailSender"/>

        <property name="rememberTokenDao" ref="rememberTokenDao"/>
        <property name="accountRecoveryManager" ref="accountRecoveryManager"/>
        <property name="sessionCustomHouse" ref="sessionCustomHouse"/>
    </bean>

    <bean name="/rpc/ProblemsReportService"
          class="wisematches.server.deprecated.web.modules.core.services.ProblemsReportServiceImpl">
        <property name="mailSender" ref="mailSender"/>

        <property name="problemsReportDao" ref="problemsReportDao"/>

        <property name="emailNotificationTeams">
            <set>
                <value>BUGS_TEAM</value>
            </set>
        </property>
    </bean>

    <bean name="/rpc/DashboardService"
          class="wisematches.server.deprecated.web.modules.app.services.DashboardServiceImpl">
        <property name="roomsManager" ref="roomsManager"/>
        <property name="playerManager" ref="playerManager"/>
    </bean>

    <bean name="/rpc/ApplicationSettingsService"
          class="wisematches.server.deprecated.web.modules.app.services.ApplicationSettingsServiceImpl">
        <property name="playerSettingsDao" ref="playerSettingsDao"/>
    </bean>

    <bean name="/rpc/EventsDispatcherService"
          class="wisematches.server.deprecated.web.modules.app.services.EventsDispatcherServiceImpl"/>

    <bean name="/rpc/PlayboardService"
          class="wisematches.server.deprecated.web.modules.app.services.PlayboardServiceImpl">
        <property name="roomsManager" ref="roomsManager"/>
        <property name="playerManager" ref="playerManager"/>
    </bean>

    <bean name="/rpc/PlayerInfoService"
          class="wisematches.server.deprecated.web.modules.app.services.PlayerInfoServiceImpl">
        <property name="playerStatisticsManager" ref="playerStatisticsManager"/>
        <property name="playerManager" ref="playerManager"/>
        <property name="playerSessionsManager" ref="playerSessionsManager"/>
    </bean>

    <bean name="/rpc/ApplicationStatisticService"
          class="wisematches.server.deprecated.web.modules.app.services.ApplicationStatisticServiceImpl">
        <property name="ratingsManager" ref="ratingsManager"/>
        <property name="playerSessionsManager" ref="playerSessionsManager"/>
        <property name="accountManager" ref="accountManager"/>
        <property name="roomManagerFacade" ref="scribbleRoomManagerFacade"/>
    </bean>

    <bean name="/rpc/ProfileService"
          class="wisematches.server.deprecated.web.modules.app.services.PlayerProfileServiceImpl">
        <property name="playerStatisticsManager" ref="playerStatisticsManager"/>
        <property name="playerManager" ref="playerManager"/>
        <property name="ratingsManager" ref="ratingsManager"/>
        <property name="countriesManager" ref="countriesManager"/>
        <property name="roomsManager" ref="roomsManager"/>
    </bean>

    <bean name="/rpc/GameboardService"
          class="wisematches.server.deprecated.web.modules.app.services.GameboardServiceImpl">
        <property name="roomsManager" ref="roomsManager"/>
        <property name="playerManager" ref="playerManager"/>
    </bean>

    <bean name="/rpc/MemoryWordsService"
          class="wisematches.server.deprecated.web.modules.app.services.MemoryWordsServiceImpl">
        <property name="memoryWordsManager" ref="memoryWordsManager"/>
        <property name="roomsManager" ref="roomsManager"/>
    </bean>

    <bean name="/rpc/PlayerImagesService"
          class="wisematches.server.deprecated.web.modules.app.services.PlayerImagesServiceImpl">
        <property name="playerImagesManager" ref="playerImagesManager"/>
        <property name="noImageImageUrl" value="images/noPlayerIcon.png"/>
        <property name="playerSessionsManager" ref="playerSessionsManager"/>
    </bean>

    <bean name="/rpc/JSONCountriesList"
          class="wisematches.server.deprecated.web.modules.app.services.JsonCountriesServlet">
        <property name="countriesManager" ref="countriesManager"/>
    </bean>

</beans>
