<?xml version="1.0" encoding="UTF-8"?>

<!--
  ~ Copyright (c) 2011, WiseMatches (by Sergey Klimenko).
  -->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="authenticationHandler" class="wisematches.server.web.spring.security.ExtJSAuthenticationHandler"/>

    <bean id="ipTokenBasedRememberMeServicesBean"
          class="wisematches.server.web.spring.security.IPTokenBasedRememberMeServices">
        <property name="key" value="jbcpPetStore"/>
        <property name="userDetailsService" ref="jdbcUserService"/>
        <property name="parameter" value="_remember_me"/>
        <property name="cookieName" value="REMEMBER_ME"/>
    </bean>

    <bean id="jdbcUserService" class="org.springframework.security.provisioning.JdbcUserDetailsManager">
        <property name="dataSource" ref="dataSource"/>
        <property name="authenticationManager" ref="authenticationManager"/>
        <property name="enableGroups" value="true"/>
        <property name="enableAuthorities" value="false"/>
    </bean>

    <bean id="passwordEncoder" class="org.springframework.security.authentication.encoding.ShaPasswordEncoder"/>

    <bean id="saltSource" class="org.springframework.security.authentication.dao.ReflectionSaltSource" >
        <property name="userPropertyToUse" value="username"/>
    </bean>
</beans>